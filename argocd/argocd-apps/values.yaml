applications:
  # ARGOCD
  argocd:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: argocd
    destination:
      namespace: argocd
      server: https://kubernetes.default.svc
    project: argocd
    sources:
      - repoURL: https://argoproj.github.io/argo-helm
        chart: argo-cd
        targetRevision: 6.8.1
        helm:
          valueFiles:
          - $values/argocd/argocd/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    ignoreDifferences:
      - kind: Secret
        name: argocd-secret
        namespace: argocd
        jsonPointers:
          - /data
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      syncOptions:
        - CreateNamespace=true
        - RespectIgnoreDifferences=true

  argocd-apps:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: argocd
    destination:
      namespace: argocd
      server: https://kubernetes.default.svc
    project: argocd
    sources:
      - repoURL: https://argoproj.github.io/argo-helm
        chart: argocd-apps
        targetRevision: 2.0.0
        helm:
          valueFiles:
          - $values/argocd/argocd-apps/values.yaml
          - $values/argocd/argocd-apps/projects.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true

  # CILIUM
  # Issue with https://github.com/cilium/cilium-cli/issues/1396
  cilium:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: kube-system
    destination:
      namespace: kube-system
      server: https://kubernetes.default.svc
    project: system
    sources:
      - repoURL: https://helm.cilium.io
        chart: cilium
        targetRevision: 1.15.4
        helm:
          valueFiles:
          - $values/cilium/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    ignoreDifferences:
      - kind: Secret
        name: cilium-ca
        namespace: kube-system
        jsonPointers:
          - /data
      - kind: Secret
        name: hubble-ca-secret
        namespace: kube-system
        jsonPointers:
          - /data
      - kind: Secret
        name: hubble-server-certs
        namespace: kube-system
        jsonPointers:
          - /data
      - kind: Secret
        name: hubble-relay-client-certs
        namespace: kube-system
        jsonPointers:
          - /data
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      syncOptions:
        - CreateNamespace=true
        - RespectIgnoreDifferences=true

# CERT-MANAGER
  cert-manager:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: cert-manager
    destination:
      namespace: cert-manager
      server: https://kubernetes.default.svc
    project: system
    sources:
      - repoURL: https://charts.jetstack.io
        chart: cert-manager
        targetRevision: v1.14.5
        helm:
          valueFiles:
          - $values/cert-manager/cert-manager/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  cluster-issuer:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: cert-manager
    destination:
      namespace: cert-manager
      server: https://kubernetes.default.svc
    project: system
    sources:
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        path: cert-manager/cluster-issuer
        helm:
          valueFiles:
          - values.yaml
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

# METALLB
  metallb:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: metallb
    destination:
      namespace: metallb
      server: https://kubernetes.default.svc
    project: system
    sources:
      - repoURL: https://metallb.github.io/metallb
        chart: metallb
        targetRevision: 0.14.5
        helm:
          valueFiles:
          - $values/metallb/metallb/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    ignoreDifferences:
      - kind: CustomResourceDefinition
        group: "apiextensions.k8s.io"
        name: bgppeers.metallb.io
        jsonPointers:
          - /spec/conversion/webhook/clientConfig/caBundle
      - kind: CustomResourceDefinition
        group: "apiextensions.k8s.io"
        name: addresspools.metallb.io
        jsonPointers:
          - /spec/conversion/webhook/clientConfig/caBundle
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true
        - RespectIgnoreDifferences=true

  metallb-ipaddress-pool:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: metallb
    destination:
      namespace: metallb
      server: https://kubernetes.default.svc
    project: system
    sources:
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        path: metallb/metallb-ipaddresspool
        helm:
          valueFiles:
          - values.yaml
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

# TRAEFIK
  traefik:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: traefik
    destination:
      namespace: traefik
      server: https://kubernetes.default.svc
    project: system
    sources:
      - repoURL: https://traefik.github.io/charts
        chart: traefik
        targetRevision: 28.0.0
        helm:
          valueFiles:
          - $values/traefik/traefik/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  traefik-dashboard:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: traefik
    destination:
      namespace: traefik
      server: https://kubernetes.default.svc
    project: system
    sources:
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        path: traefik/traefik-dashboard
        helm:
          valueFiles:
          - values.yaml
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

# K8S SIGS
  metrics-server:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: kube-system
    destination:
      namespace: kube-system
      server: https://kubernetes.default.svc
    project: system
    sources:
      - repoURL: https://kubernetes-sigs.github.io/metrics-server
        chart: metrics-server
        targetRevision: 3.12.1
        helm:
          valueFiles:
          - $values/utils/metrics-server/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  kubernetes-dashboard:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: kubernetes-dashboard
    destination:
      namespace: kubernetes-dashboard
      server: https://kubernetes.default.svc
    project: system
    sources:
      - repoURL: https://kubernetes.github.io/dashboard
        chart: kubernetes-dashboard
        targetRevision: 6.0.8
        helm:
          valueFiles:
          - $values/utils/kubernetes-dashboard/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  secrets-store-csi-driver:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: kube-system
    destination:
      namespace: kube-system
      server: https://kubernetes.default.svc
    project: system
    sources:
      - repoURL: https://kubernetes-sigs.github.io/secrets-store-csi-driver/charts
        chart: secrets-store-csi-driver
        targetRevision: 1.4.3
        helm:
          valueFiles:
          - $values/utils/secrets-store-csi-driver/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  kubelet-csr-approver:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: kube-system
    destination:
      namespace: kube-system
      server: https://kubernetes.default.svc
    project: system
    sources:
      - repoURL: https://postfinance.github.io/kubelet-csr-approver
        chart: kubelet-csr-approver
        targetRevision: 1.1.0
        helm:
          valueFiles:
          - $values/utils/kubelet-csr-approver/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  etcd-defrag:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: kube-system
    destination:
      namespace: kube-system
      server: https://kubernetes.default.svc
    project: system
    source:
      repoURL: git@github.com:thibaultserti/kubernetes.git
      path: utils/etcd-defrag
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  kured:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: kube-system
    destination:
      namespace: kube-system
      server: https://kubernetes.default.svc
    project: system
    sources:
      - repoURL: https://kubereboot.github.io/charts
        chart: kured
        targetRevision: 5.4.5
        helm:
          valueFiles:
          - $values/utils/kured/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

# LONGHORN
  longhorn:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: longhorn-system
    destination:
      namespace: longhorn-system
      server: https://kubernetes.default.svc
    project: system
    sources:
      - repoURL: https://charts.longhorn.io
        chart: longhorn
        targetRevision: 1.6.1
        helm:
          valueFiles:
          - $values/longhorn/longhorn/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  longhorn-backup:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: longhorn-system
    destination:
      namespace: longhorn-system
      server: https://kubernetes.default.svc
    project: system
    sources:
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        path: longhorn/longhorn-backup
        helm:
          valueFiles:
          - values.yaml
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  storage-classes:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: longhorn-system
    destination:
      namespace: longhorn-system
      server: https://kubernetes.default.svc
    project: system
    sources:
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        path: longhorn/storage-classes
        helm:
          valueFiles:
          - values.yaml
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

# VAULT
  vault:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: vault
    destination:
      namespace: vault
      server: https://kubernetes.default.svc
    project: vault
    sources:
      - repoURL: https://helm.releases.hashicorp.com
        chart: vault
        targetRevision: 0.28.0
        helm:
          valueFiles:
          - $values/vault/vault/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    ignoreDifferences:
      - group: admissionregistration.k8s.io
        kind: MutatingWebhookConfiguration
        jqPathExpressions:
        - .webhooks[]?.clientConfig.caBundle
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true
        - RespectIgnoreDifferences=true

  secrets-stores:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: vault
    destination:
      namespace: vault
      server: https://kubernetes.default.svc
    project: vault
    sources:
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        path: vault/secrets-stores
        helm:
          valueFiles:
          - values.yaml
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true


# EXTERNAL DNS
  external-dns:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: external-dns
    destination:
      namespace: external-dns
      server: https://kubernetes.default.svc
    project: system
    sources:
      - repoURL: https://kubernetes-sigs.github.io/external-dns/
        chart: external-dns
        targetRevision: 1.14.4
        helm:
          valueFiles:
          - $values/utils/external-dns/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true


# GRAFANA
  grafana:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: monitoring
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    sources:
      - repoURL: https://grafana.github.io/helm-charts
        chart: grafana
        targetRevision: 7.3.11
        helm:
          valueFiles:
          - $values/monitoring/grafana/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

# KSM
  kube-state-metrics:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: monitoring
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    sources:
      - repoURL: https://prometheus-community.github.io/helm-charts
        chart: kube-state-metrics
        targetRevision: 5.19.0
        helm:
          valueFiles:
          - $values/monitoring/kube-state-metrics/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

# KUBE-PROMETHEUS-STACK
  # prometheus-stack:
  #   namespace: argocd
  #   additionalAnnotations:
  #     notifications.argoproj.io/subscribe.grafana: monitoring
  #   destination:
  #     namespace: monitoring
  #     server: https://kubernetes.default.svc
  #   project: monitoring
  #   sources:
  #     - repoURL: https://prometheus-community.github.io/helm-charts
  #       chart: kube-prometheus-stack
  #       targetRevision: 55.11.0
  #       helm:
  #         skipCrds: true
  #         valueFiles:
  #         - $values/monitoring/prometheus-stack/alertmanager.yaml
  #         - $values/monitoring/prometheus-stack/alertmanagerconfig.yaml
  #         - $values/monitoring/prometheus-stack/prometheus.yaml
  #         - $values/monitoring/prometheus-stack/promrules.yaml
  #         - $values/monitoring/prometheus-stack/values.yaml
  #     - repoURL: git@github.com:thibaultserti/kubernetes.git
  #       targetRevision: HEAD
  #       ref: values
  #   ignoreDifferences:
  #     - group: admissionregistration.k8s.io
  #       kind: MutatingWebhookConfiguration
  #       jqPathExpressions:
  #         - '.webhooks[]?.clientConfig.caBundle'
  #         - '.webhooks[]?.failurePolicy'
  #     - group: admissionregistration.k8s.io
  #       kind: ValidatingWebhookConfiguration
  #       jqPathExpressions:
  #         - '.webhooks[]?.clientConfig.caBundle'
  #         - '.webhooks[]?.failurePolicy'
  #   syncPolicy:
  #     managedNamespaceMetadata:
  #       labels:
  #         goldilocks.fairwinds.com/enabled: "true"
  #     # automated:
  #     #   selfHeal: true
  #     #   prune: true
  #     syncOptions:
  #       - CreateNamespace=true
  #       - RespectIgnoreDifferences=true

  prometheus-stack-crds:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: monitoring
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    source:
      repoURL: https://github.com/prometheus-community/helm-charts.git
      path: charts/kube-prometheus-stack/charts/crds/
      directory:
        recurse: true
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      syncOptions:
        - CreateNamespace=true
        - Replace=true
      automated:
        prune: true
        selfHeal: true

  vm-stack:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: monitoring
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    sources:
      - repoURL: https://victoriametrics.github.io/helm-charts/
        chart: victoria-metrics-k8s-stack
        targetRevision: 0.22.0
        helm:
          skipCrds: true
          valueFiles:
          - $values/monitoring/victoria-metrics-stack/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

# EXPORTERS
  node-exporter:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: monitoring
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    sources:
      - repoURL: https://prometheus-community.github.io/helm-charts
        chart: prometheus-node-exporter
        targetRevision: 4.34.0
        helm:
          valueFiles:
          - $values/monitoring/exporters/node-exporter/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  blackbox-exporter-internal:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: monitoring
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    sources:
      - repoURL: https://prometheus-community.github.io/helm-charts
        chart: prometheus-blackbox-exporter
        targetRevision: 8.16.0
        helm:
          valueFiles:
          - $values/monitoring/exporters/blackbox-exporter/internal/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  blackbox-exporter-external:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: monitoring
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    sources:
      - repoURL: https://prometheus-community.github.io/helm-charts
        chart: prometheus-blackbox-exporter
        targetRevision: 8.16.0
        helm:
          valueFiles:
          - $values/monitoring/exporters/blackbox-exporter/external/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  nginx-exporter:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: monitoring
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    sources:
      - repoURL: https://prometheus-community.github.io/helm-charts
        chart: prometheus-nginx-exporter
        targetRevision: 0.2.1
        helm:
          valueFiles:
          - $values/monitoring/exporters/nginx-exporter/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  pihole-exporter:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: monitoring
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    sources:
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        path: monitoring/exporters/pihole-exporter
        helm:
          valueFiles:
          - values.yaml
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  kepler-exporter:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: monitoring
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    sources:
      - repoURL: https://sustainable-computing-io.github.io/kepler-helm-chart
        chart: kepler
        targetRevision: 0.5.6
        helm:
          valueFiles:
          - $values/monitoring/exporters/kepler-exporter/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  falco-exporter:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: monitoring
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    sources:
      - repoURL: https://falcosecurity.github.io/charts
        chart: falco-exporter
        targetRevision: 0.11.0
        helm:
          valueFiles:
          - $values/monitoring/exporters/falco-exporter/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  speedtest-exporter:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: monitoring
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    sources:
      - repoURL: https://charts.alekc.dev
        chart: speedtest-exporter
        targetRevision: 0.1.1
        helm:
          valueFiles:
          - $values/monitoring/exporters/speedtest-exporter/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

# ROBUSTA
  robusta:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: monitoring
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    sources:
      - repoURL: https://robusta-charts.storage.googleapis.com
        chart: robusta
        targetRevision: 0.12.0
        helm:
          valueFiles:
          - $values/monitoring/robusta/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

# MINIO
  minio:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: minio
    destination:
      namespace: minio
      server: https://kubernetes.default.svc
    project: minio
    sources:
      - repoURL: registry-1.docker.io
        chart: bitnamicharts/minio
        targetRevision: 14.4.0
        helm:
          valueFiles:
          - $values/minio/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

# OPEN TELEMETRY
  opentelemetry-operator:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: monitoring
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    sources:
      - repoURL: https://open-telemetry.github.io/opentelemetry-helm-charts
        chart: opentelemetry-operator
        targetRevision: 0.57.0
        helm:
          valueFiles:
          - $values/monitoring/opentelemetry/opentelemetry-operator/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  opentelemetry-collector:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: monitoring
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    source:
      repoURL: git@github.com:thibaultserti/kubernetes.git
      path: monitoring/opentelemetry/opentelemetry-collector
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

# LOKI
  loki:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: monitoring
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    sources:
      - repoURL: https://grafana.github.io/helm-charts
        chart: loki
        targetRevision: 6.5.1
        helm:
          valueFiles:
          - $values/monitoring/loki/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  promtail:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: monitoring
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    sources:
      - repoURL: https://grafana.github.io/helm-charts
        chart: promtail
        targetRevision: 6.15.5
        helm:
          valueFiles:
          - $values/monitoring/promtail/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

# TEMPO
  tempo:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: monitoring
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    sources:
      - repoURL: https://grafana.github.io/helm-charts
        chart: tempo
        targetRevision: 1.7.3
        helm:
          valueFiles:
          - $values/monitoring/tempo/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

# PYROSCOPE
  pyroscope:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: monitoring
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    sources:
      - repoURL: https://grafana.github.io/helm-charts
        chart: pyroscope
        targetRevision: 1.5.1
        helm:
          valueFiles:
          - $values/monitoring/pyroscope/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

# THANOS
  # thanos:
  #   namespace: argocd
  #   additionalAnnotations:
  #     notifications.argoproj.io/subscribe.grafana: monitoring
  #   destination:
  #     namespace: monitoring
  #     server: https://kubernetes.default.svc
  #   project: monitoring
  #   sources:
  #     - repoURL: https://charts.bitnami.com/bitnami
  #       chart: thanos
  #       targetRevision: 12.23.2
  #       helm:
  #         valueFiles:
  #         - $values/monitoring/thanos/values.yaml
  #     - repoURL: git@github.com:thibaultserti/kubernetes.git
  #       targetRevision: HEAD
  #       ref: values
  #   syncPolicy:
  #     managedNamespaceMetadata:
  #       labels:
  #         goldilocks.fairwinds.com/enabled: "true"
  #     # automated:
  #     #   selfHeal: true
  #     #   prune: true
  #     syncOptions:
  #       - CreateNamespace=true

# STATUS PAGE
  kuma:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: monitoring
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    sources:
      - repoURL: https://dirsigler.github.io/uptime-kuma-helm
        chart: uptime-kuma
        targetRevision: 2.18.0
        helm:
          valueFiles:
          - $values/monitoring/kuma/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

# LOCUST
  locust:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: monitoring
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    sources:
      - repoURL: https://charts.deliveryhero.io/
        chart: locust
        targetRevision: 0.31.6
        helm:
          valueFiles:
          - $values/monitoring/locust/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true


# # MIMIR
#   mimir:
#     namespace: argocd
#    additionalAnnotations:
#      notifications.argoproj.io/subscribe.grafana: monitoring
#     destination:
#       namespace: monitoring
#       server: https://kubernetes.default.svc
#     project: monitoring
#     sources:
#       - repoURL: https://grafana.github.io/helm-charts
#         chart: mimir-distributed
#         targetRevision: 5.1.0-weekly.249
#         helm:
#           valueFiles:
#           - $values/monitoring/mimir/values.yaml
#       - repoURL: git@github.com:thibaultserti/kubernetes.git
#         targetRevision: HEAD
#         ref: values
#     syncPolicy:
#      managedNamespaceMetadata:
#        labels:
#          goldilocks.fairwinds.com/enabled: "true"
#       automated:
#         selfHeal: true
#         prune: true
#       syncOptions:
#         - CreateNamespace=true

# SLOTH
  sloth:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: monitoring
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    sources:
      - repoURL: https://slok.github.io/sloth
        chart: sloth
        targetRevision: 0.7.0
        helm:
          valueFiles:
          - $values/monitoring/sloth/sloth/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  slos:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: monitoring
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    sources:
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        path: monitoring/sloth/slos
        helm:
          valueFiles:
          - values.yaml
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

# KYVERNO
  kyverno:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: kyverno
    destination:
      namespace: kyverno
      server: https://kubernetes.default.svc
    project: kyverno
    sources:
      - repoURL: https://kyverno.github.io/kyverno
        chart: kyverno
        targetRevision: 3.2.2
        helm:
          valueFiles:
          - $values/kyverno/kyverno/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true
        - Replace=true

  kyverno-policies:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: kyverno
    destination:
      namespace: kyverno
      server: https://kubernetes.default.svc
    project: kyverno
    sources:
      - repoURL: https://kyverno.github.io/kyverno
        chart: kyverno-policies
        targetRevision: 3.2.1
        helm:
          valueFiles:
          - $values/kyverno/kyverno-policies/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  custom-policies:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: kyverno
    destination:
      namespace: monitoring
      server: https://kubernetes.default.svc
    project: monitoring
    source:
      repoURL: git@github.com:thibaultserti/kubernetes.git
      path: kyverno/custom-policies
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true


  policy-reporter:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: kyverno
    destination:
      namespace: kyverno
      server: https://kubernetes.default.svc
    project: kyverno
    sources:
      - repoURL: https://kyverno.github.io/policy-reporter
        chart: policy-reporter
        targetRevision: 2.22.5
        helm:
          valueFiles:
          - $values/kyverno/policy-reporter/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

# SECURITY
  trivy-operator:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: trivy
    destination:
      namespace: trivy
      server: https://kubernetes.default.svc
    project: security
    sources:
      - repoURL: https://aquasecurity.github.io/helm-charts/
        chart: trivy-operator
        targetRevision: 0.22.1
        helm:
          valueFiles:
          - $values/security/trivy-operator/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  polaris:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: polaris
    destination:
      namespace: polaris
      server: https://kubernetes.default.svc
    project: security
    sources:
      - repoURL: https://charts.fairwinds.com/stable
        chart: polaris
        targetRevision: 5.17.1
        helm:
          valueFiles:
          - $values/security/polaris/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  falco:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: falco
    destination:
      namespace: falco
      server: https://kubernetes.default.svc
    project: security
    sources:
      - repoURL: https://falcosecurity.github.io/charts
        chart: falco
        targetRevision: 4.3.0
        helm:
          valueFiles:
          - $values/security/falco/falco/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  falcosidekick:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: falco
    destination:
      namespace: falco
      server: https://kubernetes.default.svc
    project: security
    sources:
      - repoURL: https://falcosecurity.github.io/charts
        chart: falcosidekick
        targetRevision: 0.7.18
        helm:
          valueFiles:
          - $values/security/falco/falcosidekick/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

# # GOLDILOCKS
#   goldilocks:
#     namespace: argocd
#     additionalAnnotations:
#       notifications.argoproj.io/subscribe.grafana: goldilocks
#     destination:
#       namespace: goldilocks
#       server: https://kubernetes.default.svc
#     project: goldilocks
#     sources:
#       - repoURL: https://charts.fairwinds.com/stable
#         chart: goldilocks
#         targetRevision: 8.0.1
#         helm:
#           valueFiles:
#           - $values/goldilocks/values.yaml
#       - repoURL: git@github.com:thibaultserti/kubernetes.git
#         targetRevision: HEAD
#         ref: values
#     syncPolicy:
#       managedNamespaceMetadata:
#         labels:
#           goldilocks.fairwinds.com/enabled: "true"
#       automated:
#         selfHeal: true
#         prune: true
#       syncOptions:
#         - CreateNamespace=true

  # tetragon:
  #   namespace: argocd
  #   additionalAnnotations:
  #     notifications.argoproj.io/subscribe.grafana: tetragon
  #   destination:
  #     namespace: tetragon
  #     server: https://kubernetes.default.svc
  #   project: security
  #   sources:
  #     - repoURL: https://helm.cilium.io/
  #       chart: tetragon
  #       targetRevision: 0.10.0
  #       helm:
  #         valueFiles:
  #         - $values/security/tetragon/values.yaml
  #     - repoURL: git@github.com:thibaultserti/kubernetes.git
  #       targetRevision: HEAD
  #       ref: values
  #   syncPolicy:
  #     automated:
  #       selfHeal: true
  #       prune: true
  #     syncOptions:
  #       - CreateNamespace=true

# TELEPORT
  teleport:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: teleport
    destination:
      namespace: teleport
      server: https://kubernetes.default.svc
    project: teleport
    sources:
      - repoURL: https://charts.releases.teleport.dev
        chart: teleport-cluster
        targetRevision: 15.3.3
        helm:
          valueFiles:
          - $values/teleport/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true


# # EXAMPLES
#   opentelemetry-demo:
#     namespace: argocd
#     additionalAnnotations:
#       notifications.argoproj.io/subscribe.grafana: opentelemtry-demo
#     destination:
#       namespace: opentelemetry-demo
#       server: https://kubernetes.default.svc
#     project: example
#     sources:
#       - repoURL: https://open-telemetry.github.io/opentelemetry-helm-charts
#         chart: opentelemetry-demo
#         targetRevision: 0.22.4
#         helm:
#           valueFiles:
#           - $values/example/opentelemetry-demo/values.yaml
#       - repoURL: git@github.com:thibaultserti/kubernetes.git
#         targetRevision: HEAD
#         ref: values
#     syncPolicy:
#      managedNamespaceMetadata:
#        labels:
#          goldilocks.fairwinds.com/enabled: "true"
#       automated:
#         selfHeal: true
#         prune: true
#       syncOptions:
#         - CreateNamespace=true

  fastapi-manual-instrumented:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: fastapi-manual-instrumented
    destination:
      namespace: example
      server: https://kubernetes.default.svc
    project: example
    sources:
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        path: example/fastapi-observability-example/manual-instrumented
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true



# CTFD
  ctfd:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: ctfd
    destination:
      namespace: ctfd
      server: https://kubernetes.default.svc
    project: ctfd
    sources:
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        path: ctfd
        helm:
          valueFiles:
          - values.yaml
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

# REDIS
  redis:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: redis
    destination:
      namespace: redis
      server: https://kubernetes.default.svc
    project: redis
    sources:
      - repoURL: https://charts.bitnami.com/bitnami
        chart: redis
        targetRevision: 19.3.0
        helm:
          valueFiles:
          - $values/redis/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

# HOME PAGE
  homepage:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: homepage
    destination:
      namespace: homepage
      server: https://kubernetes.default.svc
    project: services
    sources:
      - repoURL: http://jameswynn.github.io/helm-charts
        chart: homepage
        targetRevision: 1.2.3
        helm:
          valueFiles:
          - $values/services/homepage/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true


# YOPASS

  yopass:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: yopass
    destination:
      namespace: yopass
      server: https://kubernetes.default.svc
    project: services
    sources:
      - repoURL: https://cloudhippie.github.io/charts
        chart: yopass
        targetRevision: 3.2.1
        helm:
          valueFiles:
          - $values/services/yopass/values.yaml
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        targetRevision: HEAD
        ref: values
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

# STRILING PDF
  stirling-pdf:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: stirling-pdf
    destination:
      namespace: stirling-pdf
      server: https://kubernetes.default.svc
    project: services
    source:
      repoURL: git@github.com:thibaultserti/kubernetes.git
      path: services/stirling-pdf
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

# MY-APPS

  challenges:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: my-apps
    destination:
      namespace: my-apps
      server: https://kubernetes.default.svc
    project: my-apps
    sources:
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        path: my-apps/challenges
        helm:
          valueFiles:
          - values.yaml
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true

  ovh-certificate-api:
    namespace: argocd
    additionalAnnotations:
      notifications.argoproj.io/subscribe.grafana: my-apps
    destination:
      namespace: my-apps
      server: https://kubernetes.default.svc
    project: my-apps
    sources:
      - repoURL: git@github.com:thibaultserti/kubernetes.git
        path: my-apps/ovh-certificate-api
        helm:
          valueFiles:
          - values.yaml
    syncPolicy:
      managedNamespaceMetadata:
        labels:
          goldilocks.fairwinds.com/enabled: "true"
      automated:
        selfHeal: true
        prune: true
      syncOptions:
        - CreateNamespace=true
